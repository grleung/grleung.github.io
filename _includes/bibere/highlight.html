{% assign minYear = include.minYear |  to_integer %}
<!-- Create a list of papers filtered by flags -->
{% assign filtered = '' | split: '' %}
{%- for p in site.data.bibere.papers -%}
        {%- if include.filterAuthor %}
            {%- if p[1].authors[0] == include.filterAuthor -%}
                {% assign filtered = filtered | push: p %}
            {%- endif -%}
        {%- else -%}
            {% assign filtered = filtered | push: p %}
        {%- endif -%}
{%- endfor -%}
<!-- Group filtered ones by year, sorted -->
{% assign years = filtered | group_by_exp: "p",
"p[1].year" | sort: "name" | reverse %}

{% for year in years %}
    {% assign types = year.items | group_by_exp: "p", "p[1].type" | sort: "name" %}
    {% for type in types %}
        {% assign weights = type.items | group_by_exp: "p", "p[1].sort_weight" | sort: "name" | reverse %}
        {% for weight in weights %}
            {% for p in weight.items %}
                {%- assign pid = p[0] -%}
                {% include bibere/paper.html pid=pid mainAuthor=include.mainAuthor %}
            {% endfor %}
        {% endfor %}
    {% endfor %}
{% endfor %}